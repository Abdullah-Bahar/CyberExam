
--------------------------------------------------------
	Authentication Bypass by Cookie Manipulation
--------------------------------------------------------

* Base64 tabanlı cookie'leri çözümlemek için
	- https://www.base64decode.org/
	- https://jwt.io/

-------------------------------------

	BASE64 NASIL ÇALIŞIR ? 

* Veriler 6-bitlik parçalara bölünür.
* Bölünen 6-bitlik parçaların geldiği değerler base32 tablosuna göre belirlenir.
* Veriler : A-Z, a-z, 0-9, +, /, ("=" padding değeri)
* Veri 6'nın katı olmadığında 6'nın katına tamamlamak için padding değeri eklenir sonuna


	BASE32 NASIL ÇALIŞIR ? 

* Veriler 5-bitlik parçalara bölünür.
* Bölünen 5-bitlik parçaların geldiği değerler base32 tablosuna göre belirlenir.
* Veriler : A-Z, 2-9, ("=" padding değeri)
* Veri 5'nın katı olmadığında 6'nın katına tamamlamak için padding değeri eklenir sonuna

-------------------------------------

* Cookie 3 değer taşır : 
	- header
	- payload
	- signature

* "header.payload.signature"

-------------------------------------

	MAKİNADAKİ COOKİE İÇİN REQUEST ve RESPONSE

1. Register için
	* REQUEST :
		- Kullanıcı Adı ve Şifre Belirleniyor (POST) 

	* RESPONSE : 
		- Set-Cookie : <sessionID-1>

2. Login giriş
	* REQUEST :
		- Kullanıcı Adı ve Şifre Gönderiliyor (POST)

	* RESPONSE :
		- Set-Cookie : <usurname> 
		- Set-Cookie : <sessionID-2>

3. Login sonrası
	* REQUEST :
		- Cookie : <usurname>

	* RESPONSE :
		- Web sitesindeki girdiği yer ile alaklı öğeler

4. Logout sonraıs :
	* REQUEST :
		- Cookie : <username> 

	* RESPONSE :
		- Set-Cookie : <sessionID-3>

-------------------------------------

	Makine'nin Çözümü

* Login yaparken girilen kullanıcı adı ile birlikte cookie değerleri oluşturuluyor server tarafından 
	- usurname ve session

* Site içerisinde login bir şekilde gezinmek için tarayıcı tarafından "usurname cookie" değeri kullanılıyor.

* Bu "usurname cookie" değeri ise kullanıcı adının revers halinin base32 ile hashlenmiş hali
	- Mesela : Naber -> rebaN -> Base32 ile hashleniyor

NOT : Login yapılan kullanıcıdan çıkış yapmak için url'e "/logout" yazıyorum. 

-------------------------------------

	KODLAR

* echo "admin" | rev | base32 	
	- admin kelimesini terse çevirip base32'ye kodlar.

* echo "base32" | base32 -d 
	- base32 kodunu decode eder

* echo "base64" | base64 -d 
	- base64 kodunu decode eder

-------------------------------------

	İNCELE = Cookie Açıkları

* session fixation
* predictable session ID
* weak token generation

-------------------------------------
